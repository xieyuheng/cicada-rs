<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2017-09-25 Mon 02:40 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>essence</title>
<meta name="generator" content="Org-mode" />
<meta name="author" content="xieyuheng" />
<link rel="stylesheet" type="text/css" href="css/org-page.css"/>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">essence</h1>
<div id="table-of-contents">
<h2>overview</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org3bb7908"><span class="todo _todo_list_">[todo-list]</span> </a>
<ul>
<li><a href="#orga211679">esse as sequent1 and sequent0 in jojo</a></li>
<li><a href="#org3361e7a">esse in esse</a></li>
<li><a href="#org41e8f4c">recall the old &lt;red-black-tree&gt; proof</a></li>
<li><a href="#org6cd6ce9">use number theory to test esse as prover</a></li>
<li><a href="#org62a8ba4">use category theory to test type-class</a></li>
</ul>
</li>
<li><a href="#org334f85f"><span class="todo _note_">[note]</span> </a>
<ul>
<li><a href="#orgeace529">many languages</a></li>
<li><a href="#org2a55e22">(:)</a></li>
<li><a href="#orga009b31">function name overload</a></li>
</ul>
</li>
<li><a href="#org5cfe633">number</a>
<ul>
<li><a href="#org7672948">&lt;bool&gt;</a></li>
<li><a href="#org8b2c9be">&lt;nat&gt;</a></li>
<li><a href="#orgf18dc37">&lt;even&gt;</a></li>
<li><a href="#org8f3c5d9">&lt;eq&gt; &#x2013; an interface to the internal unification</a></li>
<li><a href="#orge33cdf">add-associative &#x2013; structural induction proof</a></li>
<li><a href="#orgdd5ba4c">add-commutative</a></li>
<li><a href="#orgadcd801"><span class="todo _note_">[note]</span> type-check detail of 'add-zero-commutative'</a></li>
<li><a href="#org5b1ab1"><span class="todo _note_">[note]</span> type-check detail of 'add-commutative'</a></li>
</ul>
</li>
<li><a href="#orgb75f0b1">&lt;list&gt;</a>
<ul>
<li><a href="#org45e83e5">&lt;list&gt;</a></li>
<li><a href="#org9585594">length</a></li>
<li><a href="#org383cb87">map</a></li>
<li><a href="#org9c64867">ref</a></li>
<li><a href="#orgbdb20a9">remove-first</a></li>
</ul>
</li>
<li><a href="#org6d211a8">&lt;has-length&gt;</a>
<ul>
<li><a href="#org77c615b">&lt;has-length&gt;</a></li>
<li><a href="#org86a9129"><span class="todo _note_">[note]</span> type-check detail of 'map-has-length'</a></li>
</ul>
</li>
<li><a href="#orgf995233">&lt;sexp&gt; &#x2013; symbol expression</a>
<ul>
<li><a href="#org576c713">&lt;sexp&gt;</a></li>
<li><a href="#org50b2590">subst</a></li>
</ul>
</li>
<li><a href="#orgb3e19be">&lt;lexp&gt; &#x2013; lambda expression</a>
<ul>
<li><a href="#orga9e0a05">&lt;lexp&gt;</a></li>
<li><a href="#orgb7ccf61">occurs-free?</a></li>
</ul>
</li>
<li><a href="#orge83efc5">&lt;vector&gt;</a>
<ul>
<li><a href="#org12b0352">&lt;vector&gt;</a></li>
<li><a href="#org6e18c6b">append</a></li>
<li><a href="#org4267547">map</a></li>
<li><a href="#org5688ba3"><span class="todo _note_">[note]</span> type-check detail of 'append'</a></li>
<li><a href="#orgecbc8d5"><span class="todo _note_">[note]</span> type-check detail of 'map'</a></li>
<li><a href="#orgadf3eea">&lt;list&gt; as forgetful functor &#x2013; to reuse &lt;vector&gt;</a></li>
</ul>
</li>
<li><a href="#org4e4766d">&lt;binary-tree&gt;</a>
<ul>
<li><a href="#org470115">&lt;binary-tree&gt;</a></li>
</ul>
</li>
<li><a href="#org40e208d">&lt;binary-search-tree&gt;</a>
<ul>
<li><a href="#org8c94fe6">&lt;binary-search-tree&gt;</a></li>
<li><a href="#org4976c2a">search</a></li>
<li><a href="#org6b2d045">insert</a></li>
<li><a href="#org6e35e86">delete</a></li>
</ul>
</li>
<li><a href="#org502be66"><span class="todo _gt__lt_">&gt;&lt;</span> &lt;red-black-tree&gt;</a>
<ul>
<li><a href="#org690dd9d"><span class="todo _note_">[note]</span> </a></li>
<li><a href="#org4347b49">&lt;red-black-tree&gt; &#x2013; extrinsic</a></li>
<li><a href="#org62c928e">&lt;red-black-tree&gt; &#x2013; intrinsic</a></li>
</ul>
</li>
<li><a href="#org242e298">type-class as subtype of </a>
<ul>
<li><a href="#org21eda19"></a></li>
<li><a href="#org21ce4ce"></a></li>
<li><a href="#org524dd53">&lt;maybe&gt;</a></li>
<li><a href="#org7b02b18">&lt;state&gt;</a></li>
</ul>
</li>
<li><a href="#orgb6a941f">quotype &#x2013; quotient type</a>
<ul>
<li><a href="#org8c6f2d4"><span class="todo _note_">[note]</span> </a></li>
<li><a href="#org4bd4140">&lt;int&gt;</a></li>
<li><a href="#org4e61c0d">equal?</a></li>
<li><a href="#orgac2c448">&lt;fraction&gt;</a></li>
<li><a href="#orga998f2f">equal?</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-org3bb7908" class="outline-2">
<h2 id="org3bb7908"><span class="todo _todo_list_">[todo-list]</span> </h2>
<div class="outline-text-2" id="text-org3bb7908">
</div><div id="outline-container-orga211679" class="outline-3">
<h3 id="orga211679">esse as sequent1 and sequent0 in jojo</h3>
<div class="outline-text-3" id="text-orga211679">
<ul class="org-ul">
<li><p><p></p><p>can I re-design sequent0</p><p>by firstly design a small core ?</p><p></p></p><p></p><p><p></p><p>or can I design an over-simplified version first ?</p><p></p></p></li>

<li><p>local var can be non-determined</p></li>

<li><p>trunk as value which can be unified</p><p></p><p><ol class="org-ol"></p><p><li>there are non-determined var</li></p><p></p><p><li>when applying a function to non-determined var</p><p>it can not really return determined value</p><p>this is where we need to form a trunk</li></p><p></p><p><li>if we can not determine a non-determined trunk now</p><p>after some binding</p><p>we might be able to determine it</p><p>thus every time we see a trunk</p><p>we try to determine it</li></p><p></p><p><li>two non-determined trunk might be unified with each other</p><p>if the function body to be applied are</p><p>[structurally] the same</p><p>and their arguments can be unified</li></p><p></p><p><li><p></p><p>equivalence between function body</p><p>is not limited to 'structurally the same'</p><p></p></p><p></p><p><p></p><p>'add-commutative' is just saying (= {add} {swap add})</p><p>'add-associative' is just saying (= {add :z add} {:z add add})</p><p></p></p><p></p><p><p></p><p>we just need to supply the arguments of the function</p><p>to get back (+proof add-commutative)</p><p>and (+proof add-commutative)</p><p></p></li></ol></p></li>

<li><p>when type-apply</p><p></p><p><ul class="org-ul"></p><p><li><p><p></p><p>function cut</p><p></p></p><p><ul class="org-ul"></p><p><li><p>such as 'recur' and 'eq-apply'</p></li></ul></p><p><p></p><p>the information needed to apply the function body</p><p>is not there</p><p>so we use its type</p><p>to do a cut</p><p></p></p></li></p><p></p><p><li><p><p></p><p>data and variable</p><p></p></p><p><ul class="org-ul"></p><p><li><p>such as ':m.pre' and '{succ}'</p></li></ul></p><p><p></p><p>do not cut</p><p>they already contain more information</p><p>than their type</p><p></p></p></li></ul></p></li>

<li><p>can cut not happen in trunk ?</p><p><ul class="org-ul"></p><p><li><p>check the examples we have now</p></li></ul></p></li></ul>
</div>
</div>

<div id="outline-container-org3361e7a" class="outline-3">
<h3 id="org3361e7a">esse in esse</h3>
<div class="outline-text-3" id="text-org3361e7a">
<ul class="org-ul">
<li><p>forgetful functor &#x2013; code generation</p></li>

<li><p>equivalence &#x2013; quotype</p></li>

<li><p>unification &#x2013; uses 'equal?'</p></li>

<li><p>module &#x2013; name space</p></li></ul>
</div>
</div>

<div id="outline-container-org41e8f4c" class="outline-3">
<h3 id="org41e8f4c">recall the old &lt;red-black-tree&gt; proof</h3>
</div>

<div id="outline-container-org6cd6ce9" class="outline-3">
<h3 id="org6cd6ce9">use number theory to test esse as prover</h3>
</div>

<div id="outline-container-org62a8ba4" class="outline-3">
<h3 id="org62a8ba4">use category theory to test type-class</h3>
<div class="outline-text-3" id="text-org62a8ba4">
<ul class="org-ul">
<li><p>group theory</p></li></ul>
</div>
</div>
</div>

<div id="outline-container-org334f85f" class="outline-2">
<h2 id="org334f85f"><span class="todo _note_">[note]</span> </h2>
<div class="outline-text-2" id="text-org334f85f">
</div><div id="outline-container-orgeace529" class="outline-3">
<h3 id="orgeace529">many languages</h3>
<div class="outline-text-3" id="text-orgeace529">
<ol class="org-ol">
<li>type-name as data-constructor-name
<ul class="org-ul">
<li><p>can not use forgetful functor</p></li>
<li><p>can not overload data-constructor-name</p></li>
<li><p>simple sumtype and product-type</p></li></ul></li>

<li>type-name different from data-constructor-name
<ul class="org-ul">
<li><p>can use forgetful functor</p></li></ul></li></ol>
</div>
</div>

<div id="outline-container-org2a55e22" class="outline-3">
<h3 id="org2a55e22">(:)</h3>
<div class="outline-text-3" id="text-org2a55e22">
<ul class="org-ul">
<li><p>(:) collects its body</p><p>and treat the last value of the body</p><p>as the type to be unified</p></li></ul>
</div>
</div>

<div id="outline-container-orga009b31" class="outline-3">
<h3 id="orga009b31">function name overload</h3>
<div class="outline-text-3" id="text-orga009b31">
<ul class="org-ul">
<li><p>a function name dispatches over its input type</p></li>
<li><p>a constructor name dispatches over its output type</p></li></ul>
</div>
</div>
</div>

<div id="outline-container-org5cfe633" class="outline-2">
<h2 id="org5cfe633">number</h2>
<div class="outline-text-2" id="text-org5cfe633">
</div><div id="outline-container-org7672948" class="outline-3">
<h3 id="org7672948">&lt;bool&gt;</h3>
<div class="outline-text-3" id="text-org7672948">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+simple-type</span> <span style="color: #66d9ef; font-weight: bold;">&lt;bool&gt;</span>
  <span style="color: #66d9ef; font-weight: bold;">true</span>
  <span style="color: #66d9ef; font-weight: bold;">false</span><span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+type</span> <span style="color: #66d9ef; font-weight: bold;">&lt;bool&gt;</span> <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #696969;">)</span>
  <span style="color: #66d9ef; font-weight: bold;">true</span>  <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #66d9ef; font-weight: bold;">&lt;bool&gt;</span><span style="color: #696969;">)</span>
  <span style="color: #66d9ef; font-weight: bold;">false</span> <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #66d9ef; font-weight: bold;">&lt;bool&gt;</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org8b2c9be" class="outline-3">
<h3 id="org8b2c9be">&lt;nat&gt;</h3>
<div class="outline-text-3" id="text-org8b2c9be">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+simple-type</span> <span style="color: #66d9ef; font-weight: bold;">&lt;nat&gt;</span>
  zero
  succ <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #ae81ff;">.pre</span> <span style="color: #66d9ef; font-weight: bold;">&lt;nat&gt;</span><span style="color: #696969;">))</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+type</span> <span style="color: #66d9ef; font-weight: bold;">&lt;nat&gt;</span> <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #696969;">)</span>
  zero <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #66d9ef; font-weight: bold;">&lt;nat&gt;</span><span style="color: #696969;">)</span>
  succ <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #ae81ff;">.pre</span> <span style="color: #66d9ef; font-weight: bold;">&lt;nat&gt;</span><span style="color: #696969;">)</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #66d9ef; font-weight: bold;">&lt;nat&gt;</span><span style="color: #696969;">))</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+fun</span> add <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #a6e22e;">:m</span> <span style="color: #a6e22e;">:n</span> <span style="color: #66d9ef; font-weight: bold;">&lt;nat&gt;</span><span style="color: #696969;">)</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #66d9ef; font-weight: bold;">&lt;nat&gt;</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">match</span> <span style="color: #a6e22e;">:n</span>
    zero <span style="color: #a6e22e;">:m</span>
    succ <span style="color: #797979;">[</span><span style="color: #a6e22e;">:m</span> <span style="color: #a6e22e;">:n</span><span style="color: #ae81ff;">.pre</span> <span style="color: #66d9ef; font-weight: bold;">recur</span> succ<span style="color: #797979;">]</span><span style="color: #696969;">))</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+fun</span> mul <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #a6e22e;">:m</span> <span style="color: #a6e22e;">:n</span> <span style="color: #66d9ef; font-weight: bold;">&lt;nat&gt;</span><span style="color: #696969;">)</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #66d9ef; font-weight: bold;">&lt;nat&gt;</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">match</span> <span style="color: #a6e22e;">:n</span>
    zero <span style="color: #a6e22e;">:n</span>
    succ <span style="color: #797979;">[</span><span style="color: #a6e22e;">:m</span> <span style="color: #a6e22e;">:n</span><span style="color: #ae81ff;">.pre</span> <span style="color: #66d9ef; font-weight: bold;">recur</span> <span style="color: #a6e22e;">:n</span> add<span style="color: #797979;">]</span><span style="color: #696969;">))</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+fun</span> factorial <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #a6e22e;">:n</span> <span style="color: #66d9ef; font-weight: bold;">&lt;nat&gt;</span><span style="color: #696969;">)</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #66d9ef; font-weight: bold;">&lt;nat&gt;</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">match</span> <span style="color: #a6e22e;">:n</span>
    zero <span style="color: #797979;">[</span><span style="color: #a6e22e;">:n</span> succ<span style="color: #797979;">]</span>
    succ <span style="color: #797979;">[</span><span style="color: #a6e22e;">:n</span><span style="color: #ae81ff;">.pre</span> <span style="color: #66d9ef; font-weight: bold;">recur</span> <span style="color: #a6e22e;">:n</span> mul<span style="color: #797979;">]</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf18dc37" class="outline-3">
<h3 id="orgf18dc37">&lt;even&gt;</h3>
<div class="outline-text-3" id="text-orgf18dc37">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+type</span> <span style="color: #66d9ef; font-weight: bold;">&lt;even&gt;</span> <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #ae81ff;">.num</span> <span style="color: #66d9ef; font-weight: bold;">&lt;nat&gt;</span><span style="color: #696969;">)</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #696969;">)</span>
  zero <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #66d9ef; font-weight: bold;">--</span> zero <span style="color: #66d9ef; font-weight: bold;">&lt;even&gt;</span><span style="color: #696969;">)</span>
  plus-two <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #ae81ff;">.pre</span> <span style="color: #a6e22e;">:m</span> <span style="color: #66d9ef; font-weight: bold;">&lt;even&gt;</span><span style="color: #696969;">)</span>
            <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #a6e22e;">:m</span> succ succ <span style="color: #66d9ef; font-weight: bold;">&lt;even&gt;</span><span style="color: #696969;">))</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">proof</span> <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #66d9ef; font-weight: bold;">--</span> zero succ succ <span style="color: #66d9ef; font-weight: bold;">&lt;even&gt;</span><span style="color: #696969;">)</span>
  zero plus-two<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org8f3c5d9" class="outline-3">
<h3 id="org8f3c5d9">&lt;eq&gt; &#x2013; an interface to the internal unification</h3>
<div class="outline-text-3" id="text-org8f3c5d9">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+type</span> <span style="color: #66d9ef; font-weight: bold;">&lt;eq&gt;</span> <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #ae81ff;">.lhs</span> <span style="color: #ae81ff;">.rhs</span> <span style="color: #a6e22e;">:&lt;t&gt;</span><span style="color: #696969;">)</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #696969;">)</span>
  <span style="color: #66d9ef; font-weight: bold;">refl</span> <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #a6e22e;">:z</span> <span style="color: #a6e22e;">:z</span> <span style="color: #66d9ef; font-weight: bold;">&lt;eq&gt;</span><span style="color: #696969;">))</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+proof</span> eq-apply
  <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:x</span> <span style="color: #a6e22e;">:y</span> <span style="color: #66d9ef; font-weight: bold;">&lt;eq&gt;</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #a6e22e;">:f</span> <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:&lt;t1&gt;</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #a6e22e;">:&lt;t2&gt;</span><span style="color: #696969;">))</span>
   <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #a6e22e;">:x</span> <span style="color: #a6e22e;">:f</span> apply<span style="color: #f92672; font-weight: bold;">,</span> <span style="color: #a6e22e;">:y</span> <span style="color: #a6e22e;">:f</span> apply<span style="color: #f92672; font-weight: bold;">,</span> <span style="color: #66d9ef; font-weight: bold;">&lt;eq&gt;</span><span style="color: #696969;">)</span>
  <span style="color: #66d9ef; font-weight: bold;">refl</span><span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+proof</span> eq-swap
  <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:x</span> <span style="color: #a6e22e;">:y</span> <span style="color: #66d9ef; font-weight: bold;">&lt;eq&gt;</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #a6e22e;">:y</span> <span style="color: #a6e22e;">:x</span> <span style="color: #66d9ef; font-weight: bold;">&lt;eq&gt;</span><span style="color: #696969;">)</span>
  <span style="color: #66d9ef; font-weight: bold;">refl</span><span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+proof</span> eq-compose
  <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:x</span> <span style="color: #a6e22e;">:y</span> <span style="color: #66d9ef; font-weight: bold;">&lt;eq&gt;</span> <span style="color: #a6e22e;">:y</span> <span style="color: #a6e22e;">:z</span> <span style="color: #66d9ef; font-weight: bold;">&lt;eq&gt;</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #a6e22e;">:x</span> <span style="color: #a6e22e;">:z</span> <span style="color: #66d9ef; font-weight: bold;">&lt;eq&gt;</span><span style="color: #696969;">)</span>
  <span style="color: #66d9ef; font-weight: bold;">refl</span><span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orge33cdf" class="outline-3">
<h3 id="orge33cdf">add-associative &#x2013; structural induction proof</h3>
<div class="outline-text-3" id="text-orge33cdf">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+proof</span> add-associative
  <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #a6e22e;">:x</span> <span style="color: #a6e22e;">:y</span> <span style="color: #a6e22e;">:z</span> <span style="color: #66d9ef; font-weight: bold;">&lt;nat&gt;</span><span style="color: #696969;">)</span>
   <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #a6e22e;">:x</span> <span style="color: #a6e22e;">:y</span> add <span style="color: #a6e22e;">:z</span> add
      <span style="color: #a6e22e;">:x</span> <span style="color: #a6e22e;">:y</span> <span style="color: #a6e22e;">:z</span> add add <span style="color: #66d9ef; font-weight: bold;">&lt;eq&gt;</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">match</span> <span style="color: #a6e22e;">:z</span>
    zero <span style="color: #66d9ef; font-weight: bold;">refl</span>
    succ <span style="color: #797979;">[</span><span style="color: #a6e22e;">:x</span> <span style="color: #a6e22e;">:y</span> <span style="color: #a6e22e;">:z</span><span style="color: #ae81ff;">.pre</span> <span style="color: #66d9ef; font-weight: bold;">recur</span> <span style="color: #B380A8;">{</span>succ<span style="color: #B380A8;">}</span> eq-apply<span style="color: #797979;">]</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgdd5ba4c" class="outline-3">
<h3 id="orgdd5ba4c">add-commutative</h3>
<div class="outline-text-3" id="text-orgdd5ba4c">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+proof</span> add-commutative
  <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #a6e22e;">:m</span> <span style="color: #a6e22e;">:n</span> <span style="color: #66d9ef; font-weight: bold;">&lt;nat&gt;</span><span style="color: #696969;">)</span>
   <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #a6e22e;">:m</span> <span style="color: #a6e22e;">:n</span> add<span style="color: #f92672; font-weight: bold;">,</span> <span style="color: #a6e22e;">:n</span> <span style="color: #a6e22e;">:m</span> add <span style="color: #66d9ef; font-weight: bold;">&lt;eq&gt;</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">match</span> <span style="color: #a6e22e;">:n</span>
    zero <span style="color: #797979;">[</span><span style="color: #a6e22e;">:m</span> add-zero-commutative<span style="color: #797979;">]</span>
    succ <span style="color: #797979;">[</span><span style="color: #a6e22e;">:m</span> <span style="color: #a6e22e;">:n</span><span style="color: #ae81ff;">.pre</span> <span style="color: #66d9ef; font-weight: bold;">recur</span> <span style="color: #B380A8;">{</span>succ<span style="color: #B380A8;">}</span> eq-apply
          <span style="color: #a6e22e;">:n</span><span style="color: #ae81ff;">.pre</span> <span style="color: #a6e22e;">:m</span> add-succ-commutative eq-compose<span style="color: #797979;">]</span><span style="color: #696969;">))</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+proof</span> add-zero-commutative
  <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #a6e22e;">:m</span> <span style="color: #66d9ef; font-weight: bold;">&lt;nat&gt;</span><span style="color: #696969;">)</span>
   <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #a6e22e;">:m</span> zero add<span style="color: #f92672; font-weight: bold;">,</span> zero <span style="color: #a6e22e;">:m</span> add <span style="color: #66d9ef; font-weight: bold;">&lt;eq&gt;</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">match</span> <span style="color: #a6e22e;">:m</span>
    zero <span style="color: #66d9ef; font-weight: bold;">refl</span>
    succ <span style="color: #797979;">[</span><span style="color: #a6e22e;">:m</span><span style="color: #ae81ff;">.pre</span> <span style="color: #66d9ef; font-weight: bold;">recur</span> <span style="color: #B380A8;">{</span>succ<span style="color: #B380A8;">}</span> eq-apply<span style="color: #797979;">]</span><span style="color: #696969;">))</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+proof</span> add-succ-commutative
  <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #a6e22e;">:m</span> <span style="color: #a6e22e;">:n</span> <span style="color: #66d9ef; font-weight: bold;">&lt;nat&gt;</span><span style="color: #696969;">)</span>
   <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #a6e22e;">:m</span> succ <span style="color: #a6e22e;">:n</span> add<span style="color: #f92672; font-weight: bold;">,</span> <span style="color: #a6e22e;">:m</span> <span style="color: #a6e22e;">:n</span> add succ <span style="color: #66d9ef; font-weight: bold;">&lt;eq&gt;</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">match</span> <span style="color: #a6e22e;">:n</span>
    zero <span style="color: #66d9ef; font-weight: bold;">refl</span>
    succ <span style="color: #797979;">[</span><span style="color: #a6e22e;">:m</span> <span style="color: #a6e22e;">:n</span><span style="color: #ae81ff;">.pre</span> <span style="color: #66d9ef; font-weight: bold;">recur</span> <span style="color: #B380A8;">{</span>succ<span style="color: #B380A8;">}</span> eq-apply<span style="color: #797979;">]</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgadcd801" class="outline-3">
<h3 id="orgadcd801"><span class="todo _note_">[note]</span> type-check detail of 'add-zero-commutative'</h3>
<div class="outline-text-3" id="text-orgadcd801">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">match</span> <span style="color: #a6e22e;">:m</span> succ<span style="color: #696969;">)</span>
<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">=</span> <span style="color: #a6e22e;">:m</span> <span style="color: #a6e22e;">:m</span><span style="color: #ae81ff;">.pre</span> succ<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span>type-computed:

 <span style="color: #797979;">[</span><span style="color: #a6e22e;">:m</span><span style="color: #ae81ff;">.pre</span><span style="color: #797979;">]</span>
 <span style="color: #797979;">[</span><span style="color: #66d9ef; font-weight: bold;">recur</span> <span style="color: #B380A8;">{</span>succ<span style="color: #B380A8;">}</span> eq-apply<span style="color: #797979;">]</span>

 <span style="color: #797979;">[</span><span style="color: #a6e22e;">:m</span><span style="color: #ae81ff;">.pre</span> zero add
  zero <span style="color: #a6e22e;">:m</span><span style="color: #ae81ff;">.pre</span> add <span style="color: #66d9ef; font-weight: bold;">&lt;eq&gt;</span><span style="color: #797979;">]</span>
 <span style="color: #797979;">[</span><span style="color: #B380A8;">{</span>succ<span style="color: #B380A8;">}</span> eq-apply<span style="color: #797979;">]</span>

 <span style="color: #797979;">[</span><span style="color: #a6e22e;">:m</span><span style="color: #ae81ff;">.pre</span> zero add succ
  zero <span style="color: #a6e22e;">:m</span><span style="color: #ae81ff;">.pre</span> add succ <span style="color: #66d9ef; font-weight: bold;">&lt;eq&gt;</span><span style="color: #797979;">]</span>

 <span style="color: #797979;">[</span><span style="color: #a6e22e;">:m</span><span style="color: #ae81ff;">.pre</span> add succ
  zero <span style="color: #a6e22e;">:m</span><span style="color: #ae81ff;">.pre</span> add succ <span style="color: #66d9ef; font-weight: bold;">&lt;eq&gt;</span><span style="color: #797979;">]</span><span style="color: #696969;">)</span>

<span style="color: #696969;">(</span>type-asserted:

 <span style="color: #797979;">[</span><span style="color: #a6e22e;">:m</span> zero add
  zero <span style="color: #a6e22e;">:m</span> add <span style="color: #66d9ef; font-weight: bold;">&lt;eq&gt;</span><span style="color: #797979;">]</span>

 <span style="color: #797979;">[</span><span style="color: #a6e22e;">:m</span><span style="color: #ae81ff;">.pre</span> succ zero add
  zero <span style="color: #a6e22e;">:m</span><span style="color: #ae81ff;">.pre</span> succ add <span style="color: #66d9ef; font-weight: bold;">&lt;eq&gt;</span><span style="color: #797979;">]</span>

 <span style="color: #797979;">[</span><span style="color: #a6e22e;">:m</span><span style="color: #ae81ff;">.pre</span> succ add
  zero <span style="color: #a6e22e;">:m</span><span style="color: #ae81ff;">.pre</span> succ add <span style="color: #66d9ef; font-weight: bold;">&lt;eq&gt;</span><span style="color: #797979;">]</span>

 <span style="color: #797979;">[</span><span style="color: #a6e22e;">:m</span><span style="color: #ae81ff;">.pre</span> add succ
  zero <span style="color: #a6e22e;">:m</span><span style="color: #ae81ff;">.pre</span> succ add <span style="color: #66d9ef; font-weight: bold;">&lt;eq&gt;</span><span style="color: #797979;">]</span>

 <span style="color: #797979;">[</span><span style="color: #a6e22e;">:m</span><span style="color: #ae81ff;">.pre</span> add succ
  zero <span style="color: #a6e22e;">:m</span><span style="color: #ae81ff;">.pre</span> add succ <span style="color: #66d9ef; font-weight: bold;">&lt;eq&gt;</span><span style="color: #797979;">]</span><span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org5b1ab1" class="outline-3">
<h3 id="org5b1ab1"><span class="todo _note_">[note]</span> type-check detail of 'add-commutative'</h3>
<div class="outline-text-3" id="text-org5b1ab1">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">match</span> <span style="color: #a6e22e;">:n</span> succ<span style="color: #696969;">)</span>
<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">=</span> <span style="color: #a6e22e;">:n</span> <span style="color: #a6e22e;">:n</span><span style="color: #ae81ff;">.pre</span> succ<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span>type-computed:

 <span style="color: #797979;">[</span><span style="color: #a6e22e;">:m</span> <span style="color: #a6e22e;">:n</span><span style="color: #ae81ff;">.pre</span><span style="color: #797979;">]</span>
 <span style="color: #797979;">[</span><span style="color: #66d9ef; font-weight: bold;">recur</span> <span style="color: #B380A8;">{</span>succ<span style="color: #B380A8;">}</span> eq-apply
  <span style="color: #a6e22e;">:n</span><span style="color: #ae81ff;">.pre</span> <span style="color: #a6e22e;">:m</span> add-succ-commutative eq-swap eq-compose<span style="color: #797979;">]</span>

 <span style="color: #797979;">[</span><span style="color: #a6e22e;">:m</span> <span style="color: #a6e22e;">:n</span><span style="color: #ae81ff;">.pre</span> add
  <span style="color: #a6e22e;">:n</span><span style="color: #ae81ff;">.pre</span> <span style="color: #a6e22e;">:m</span> add <span style="color: #66d9ef; font-weight: bold;">&lt;eq&gt;</span><span style="color: #797979;">]</span>
 <span style="color: #797979;">[</span><span style="color: #B380A8;">{</span>succ<span style="color: #B380A8;">}</span> eq-apply
  <span style="color: #a6e22e;">:n</span><span style="color: #ae81ff;">.pre</span> <span style="color: #a6e22e;">:m</span> add-succ-commutative eq-swap eq-compose<span style="color: #797979;">]</span>

 <span style="color: #797979;">[</span><span style="color: #a6e22e;">:m</span> <span style="color: #a6e22e;">:n</span><span style="color: #ae81ff;">.pre</span> add succ
  <span style="color: #a6e22e;">:n</span><span style="color: #ae81ff;">.pre</span> <span style="color: #a6e22e;">:m</span> add succ <span style="color: #66d9ef; font-weight: bold;">&lt;eq&gt;</span><span style="color: #797979;">]</span>
 <span style="color: #797979;">[</span><span style="color: #a6e22e;">:n</span><span style="color: #ae81ff;">.pre</span> <span style="color: #a6e22e;">:m</span> add-succ-commutative eq-swap eq-compose<span style="color: #797979;">]</span>

 <span style="color: #797979;">[</span><span style="color: #a6e22e;">:m</span> <span style="color: #a6e22e;">:n</span><span style="color: #ae81ff;">.pre</span> add succ
  <span style="color: #a6e22e;">:n</span><span style="color: #ae81ff;">.pre</span> <span style="color: #a6e22e;">:m</span> add succ <span style="color: #66d9ef; font-weight: bold;">&lt;eq&gt;</span>
  <span style="color: #a6e22e;">:n</span><span style="color: #ae81ff;">.pre</span> succ <span style="color: #a6e22e;">:m</span> add
  <span style="color: #a6e22e;">:n</span><span style="color: #ae81ff;">.pre</span> <span style="color: #a6e22e;">:m</span> add succ <span style="color: #66d9ef; font-weight: bold;">&lt;eq&gt;</span><span style="color: #797979;">]</span>
 <span style="color: #797979;">[</span>eq-swap eq-compose<span style="color: #797979;">]</span>

 <span style="color: #797979;">[</span><span style="color: #a6e22e;">:m</span> <span style="color: #a6e22e;">:n</span><span style="color: #ae81ff;">.pre</span> add succ
  <span style="color: #a6e22e;">:n</span><span style="color: #ae81ff;">.pre</span> <span style="color: #a6e22e;">:m</span> add succ <span style="color: #66d9ef; font-weight: bold;">&lt;eq&gt;</span>
  <span style="color: #a6e22e;">:n</span><span style="color: #ae81ff;">.pre</span> <span style="color: #a6e22e;">:m</span> add succ
  <span style="color: #a6e22e;">:n</span><span style="color: #ae81ff;">.pre</span> succ <span style="color: #a6e22e;">:m</span> add <span style="color: #66d9ef; font-weight: bold;">&lt;eq&gt;</span><span style="color: #797979;">]</span>
 <span style="color: #797979;">[</span>eq-compose<span style="color: #797979;">]</span>

 <span style="color: #797979;">[</span><span style="color: #a6e22e;">:m</span> <span style="color: #a6e22e;">:n</span><span style="color: #ae81ff;">.pre</span> add succ
  <span style="color: #a6e22e;">:n</span><span style="color: #ae81ff;">.pre</span> succ <span style="color: #a6e22e;">:m</span> add <span style="color: #66d9ef; font-weight: bold;">&lt;eq&gt;</span><span style="color: #797979;">]</span><span style="color: #696969;">)</span>

<span style="color: #696969;">(</span>type-asserted:

 <span style="color: #797979;">[</span><span style="color: #a6e22e;">:m</span> <span style="color: #a6e22e;">:n</span> add
  <span style="color: #a6e22e;">:n</span> <span style="color: #a6e22e;">:m</span> add <span style="color: #66d9ef; font-weight: bold;">&lt;eq&gt;</span><span style="color: #797979;">]</span>

 <span style="color: #797979;">[</span><span style="color: #a6e22e;">:m</span> <span style="color: #a6e22e;">:n</span><span style="color: #ae81ff;">.pre</span> succ add
  <span style="color: #a6e22e;">:n</span><span style="color: #ae81ff;">.pre</span> succ <span style="color: #a6e22e;">:m</span> add <span style="color: #66d9ef; font-weight: bold;">&lt;eq&gt;</span><span style="color: #797979;">]</span>

 <span style="color: #797979;">[</span><span style="color: #a6e22e;">:m</span> <span style="color: #a6e22e;">:n</span><span style="color: #ae81ff;">.pre</span> add succ
  <span style="color: #a6e22e;">:n</span><span style="color: #ae81ff;">.pre</span> succ <span style="color: #a6e22e;">:m</span> add <span style="color: #66d9ef; font-weight: bold;">&lt;eq&gt;</span><span style="color: #797979;">]</span><span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgb75f0b1" class="outline-2">
<h2 id="orgb75f0b1">&lt;list&gt;</h2>
<div class="outline-text-2" id="text-orgb75f0b1">
</div><div id="outline-container-org45e83e5" class="outline-3">
<h3 id="org45e83e5">&lt;list&gt;</h3>
<div class="outline-text-3" id="text-org45e83e5">
<ul class="org-ul">
<li><p>&lt;list&gt; := &lt;null&gt; | (&lt;sexp&gt; . &lt;list&gt;)</p></li></ul>

<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+type</span> <span style="color: #66d9ef; font-weight: bold;">&lt;list&gt;</span> <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #ae81ff;">.&lt;t&gt;</span> <span style="color: #696969;">)</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #696969;">)</span>
  null <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #a6e22e;">:&lt;t&gt;</span> <span style="color: #66d9ef; font-weight: bold;">&lt;list&gt;</span><span style="color: #696969;">)</span>
  cons <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #ae81ff;">.cdr</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:&lt;t&gt;</span> <span style="color: #66d9ef; font-weight: bold;">&lt;list&gt;</span><span style="color: #797979;">]</span><span style="color: #696969;">)</span>
           <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #ae81ff;">.car</span> <span style="color: #a6e22e;">:&lt;t&gt;</span><span style="color: #696969;">)</span>
        <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #a6e22e;">:&lt;t&gt;</span> <span style="color: #66d9ef; font-weight: bold;">&lt;list&gt;</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org9585594" class="outline-3">
<h3 id="org9585594">length</h3>
<div class="outline-text-3" id="text-org9585594">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+fun</span> length <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #a6e22e;">:l</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:&lt;t&gt;</span> <span style="color: #66d9ef; font-weight: bold;">&lt;list&gt;</span><span style="color: #797979;">]</span><span style="color: #696969;">)</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #66d9ef; font-weight: bold;">&lt;nat&gt;</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">match</span> <span style="color: #a6e22e;">:l</span>
    null zero
    cons <span style="color: #797979;">[</span><span style="color: #a6e22e;">:l</span><span style="color: #ae81ff;">.cdr</span> <span style="color: #66d9ef; font-weight: bold;">recur</span> succ<span style="color: #797979;">]</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org383cb87" class="outline-3">
<h3 id="org383cb87">map</h3>
<div class="outline-text-3" id="text-org383cb87">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+fun</span> map <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #a6e22e;">:l</span> <span style="color: #a6e22e;">:&lt;t1&gt;</span> <span style="color: #66d9ef; font-weight: bold;">&lt;list&gt;</span><span style="color: #696969;">)</span>
              <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #a6e22e;">:f</span> <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:&lt;t1&gt;</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #a6e22e;">:&lt;t2&gt;</span><span style="color: #696969;">))</span>
           <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #a6e22e;">:&lt;t2&gt;</span> <span style="color: #66d9ef; font-weight: bold;">&lt;list&gt;</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">match</span> <span style="color: #a6e22e;">:l</span>
    null null
    cons <span style="color: #797979;">[</span><span style="color: #a6e22e;">:l</span><span style="color: #ae81ff;">.cdr</span> <span style="color: #a6e22e;">:f</span> <span style="color: #66d9ef; font-weight: bold;">recur</span><span style="color: #f92672; font-weight: bold;">,</span> <span style="color: #a6e22e;">:l</span><span style="color: #ae81ff;">.car</span> <span style="color: #a6e22e;">:f</span> apply<span style="color: #f92672; font-weight: bold;">,</span> cons<span style="color: #797979;">]</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org9c64867" class="outline-3">
<h3 id="org9c64867">ref</h3>
<div class="outline-text-3" id="text-org9c64867">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+fun</span> ref <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #a6e22e;">:l</span> <span style="color: #a6e22e;">:&lt;t&gt;</span> <span style="color: #66d9ef; font-weight: bold;">&lt;list&gt;</span><span style="color: #696969;">)</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #a6e22e;">:index</span> <span style="color: #66d9ef; font-weight: bold;">&lt;nat&gt;</span><span style="color: #696969;">)</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #a6e22e;">:&lt;t&gt;</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">match</span> <span style="color: #a6e22e;">:index</span>
    zero <span style="color: #797979;">[</span><span style="color: #a6e22e;">:l</span><span style="color: #ae81ff;">.car</span><span style="color: #797979;">]</span>
    succ <span style="color: #797979;">[</span><span style="color: #a6e22e;">:l</span><span style="color: #ae81ff;">.cdr</span> <span style="color: #a6e22e;">:index</span><span style="color: #ae81ff;">.pre</span> <span style="color: #66d9ef; font-weight: bold;">recur</span><span style="color: #797979;">]</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgbdb20a9" class="outline-3">
<h3 id="orgbdb20a9">remove-first</h3>
<div class="outline-text-3" id="text-orgbdb20a9">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+fun</span> remove-first
  <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #a6e22e;">:x</span> <span style="color: #a6e22e;">:&lt;t&gt;</span><span style="color: #696969;">)</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #a6e22e;">:l</span> <span style="color: #a6e22e;">:&lt;t&gt;</span> <span style="color: #66d9ef; font-weight: bold;">&lt;list&gt;</span><span style="color: #696969;">)</span>
   <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #a6e22e;">:&lt;t&gt;</span> <span style="color: #66d9ef; font-weight: bold;">&lt;list&gt;</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">match</span> <span style="color: #a6e22e;">:l</span>
    null null
    cons <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">match</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:l</span><span style="color: #ae81ff;">.car</span> <span style="color: #a6e22e;">:x</span> equal?<span style="color: #797979;">]</span>
           <span style="color: #66d9ef; font-weight: bold;">true</span>  <span style="color: #a6e22e;">:l</span><span style="color: #ae81ff;">.cdr</span>
           <span style="color: #66d9ef; font-weight: bold;">false</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:l</span><span style="color: #ae81ff;">.cdr</span> <span style="color: #a6e22e;">:x</span> <span style="color: #66d9ef; font-weight: bold;">recur</span> <span style="color: #a6e22e;">:l</span><span style="color: #ae81ff;">.car</span> cons<span style="color: #797979;">]</span><span style="color: #696969;">)))</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org6d211a8" class="outline-2">
<h2 id="org6d211a8">&lt;has-length&gt;</h2>
<div class="outline-text-2" id="text-org6d211a8">
</div><div id="outline-container-org77c615b" class="outline-3">
<h3 id="org77c615b">&lt;has-length&gt;</h3>
<div class="outline-text-3" id="text-org77c615b">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+type</span> <span style="color: #66d9ef; font-weight: bold;">&lt;has-length&gt;</span> <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #ae81ff;">.list</span> <span style="color: #a6e22e;">:&lt;t&gt;</span> <span style="color: #66d9ef; font-weight: bold;">&lt;list&gt;</span><span style="color: #696969;">)</span>
                        <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #ae81ff;">.length</span> <span style="color: #66d9ef; font-weight: bold;">&lt;nat&gt;</span><span style="color: #696969;">)</span>
                     <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #696969;">)</span>
  null-has-length <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #66d9ef; font-weight: bold;">--</span> null zero <span style="color: #66d9ef; font-weight: bold;">&lt;has-length&gt;</span><span style="color: #696969;">)</span>
  cons-has-length <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #ae81ff;">.cdr</span> <span style="color: #a6e22e;">:l</span> <span style="color: #a6e22e;">:n</span> <span style="color: #66d9ef; font-weight: bold;">&lt;has-length&gt;</span><span style="color: #696969;">)</span>
                   <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #a6e22e;">:l</span> <span style="color: #a6e22e;">:a</span> cons <span style="color: #a6e22e;">:n</span> succ <span style="color: #66d9ef; font-weight: bold;">&lt;has-length&gt;</span><span style="color: #696969;">))</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+fun</span> map-has-length
  <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #a6e22e;">:has-length</span> <span style="color: #a6e22e;">:l</span> <span style="color: #a6e22e;">:n</span> <span style="color: #66d9ef; font-weight: bold;">&lt;has-length&gt;</span><span style="color: #696969;">)</span>
   <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #a6e22e;">:l</span> <span style="color: #a6e22e;">:f</span> map <span style="color: #a6e22e;">:n</span> <span style="color: #66d9ef; font-weight: bold;">&lt;has-length&gt;</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">match</span> <span style="color: #a6e22e;">:has-length</span>
    null-has-length null-has-length
    cons-has-length <span style="color: #797979;">[</span><span style="color: #a6e22e;">:has-length</span><span style="color: #ae81ff;">.cdr</span> <span style="color: #66d9ef; font-weight: bold;">recur</span> cons-has-length<span style="color: #797979;">]</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org86a9129" class="outline-3">
<h3 id="org86a9129"><span class="todo _note_">[note]</span> type-check detail of 'map-has-length'</h3>
<div class="outline-text-3" id="text-org86a9129">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #a6e22e;">:has-length</span> <span style="color: #a6e22e;">:l</span> <span style="color: #a6e22e;">:n</span> <span style="color: #66d9ef; font-weight: bold;">&lt;has-length&gt;</span><span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">match</span> <span style="color: #a6e22e;">:has-length</span> cons-has-length<span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">=</span> <span style="color: #a6e22e;">:has-length</span> <span style="color: #a6e22e;">:has-length</span><span style="color: #ae81ff;">.cdr</span> cons-has-length<span style="color: #696969;">)</span>
    <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #a6e22e;">:has-length</span><span style="color: #ae81ff;">.cdr</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:l#0</span> <span style="color: #a6e22e;">:n#0</span> <span style="color: #66d9ef; font-weight: bold;">&lt;has-length&gt;</span><span style="color: #797979;">]</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #a6e22e;">:has-length</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:l#0</span> <span style="color: #a6e22e;">:a#0</span> cons <span style="color: #a6e22e;">:n#0</span> succ <span style="color: #66d9ef; font-weight: bold;">&lt;has-length&gt;</span><span style="color: #797979;">]</span><span style="color: #696969;">)</span>
    <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">=</span> <span style="color: #a6e22e;">:l</span> <span style="color: #a6e22e;">:l#0</span> <span style="color: #a6e22e;">:a#0</span> cons<span style="color: #696969;">)</span>
    <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">=</span> <span style="color: #a6e22e;">:n</span> <span style="color: #a6e22e;">:n#0</span> succ<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span>type-computed:

 <span style="color: #797979;">[</span><span style="color: #a6e22e;">:has-length</span><span style="color: #ae81ff;">.cdr</span> <span style="color: #66d9ef; font-weight: bold;">recur</span> cons-has-length<span style="color: #797979;">]</span>

 <span style="color: #797979;">[</span><span style="color: #a6e22e;">:l#0</span> <span style="color: #a6e22e;">:n#0</span> <span style="color: #66d9ef; font-weight: bold;">&lt;has-length&gt;</span><span style="color: #797979;">]</span>
 <span style="color: #797979;">[</span><span style="color: #66d9ef; font-weight: bold;">recur</span> cons-has-length<span style="color: #797979;">]</span>

 <span style="color: #797979;">[</span><span style="color: #a6e22e;">:l#0</span> <span style="color: #a6e22e;">:f#0</span> map <span style="color: #a6e22e;">:n#0</span> <span style="color: #66d9ef; font-weight: bold;">&lt;has-length&gt;</span><span style="color: #797979;">]</span>
 <span style="color: #797979;">[</span>cons-has-length<span style="color: #797979;">]</span>

 <span style="color: #797979;">[</span><span style="color: #a6e22e;">:l#0</span> <span style="color: #a6e22e;">:f#0</span> map <span style="color: #a6e22e;">:a#1</span> cons <span style="color: #a6e22e;">:n#0</span> succ <span style="color: #66d9ef; font-weight: bold;">&lt;has-length&gt;</span><span style="color: #797979;">]</span><span style="color: #696969;">)</span>

<span style="color: #696969;">(</span>type-asserted:

 <span style="color: #797979;">[</span><span style="color: #a6e22e;">:l</span> <span style="color: #a6e22e;">:f</span> map <span style="color: #a6e22e;">:n</span> <span style="color: #66d9ef; font-weight: bold;">&lt;has-length&gt;</span><span style="color: #797979;">]</span>

 <span style="color: #797979;">[</span><span style="color: #a6e22e;">:l#0</span> <span style="color: #a6e22e;">:a#0</span> cons <span style="color: #a6e22e;">:f</span> map <span style="color: #a6e22e;">:n#0</span> succ <span style="color: #66d9ef; font-weight: bold;">&lt;has-length&gt;</span><span style="color: #797979;">]</span>

 <span style="color: #797979;">[</span><span style="color: #a6e22e;">:l#0</span> <span style="color: #a6e22e;">:f</span> map <span style="color: #a6e22e;">:a#0</span> <span style="color: #a6e22e;">:f</span> apply cons <span style="color: #a6e22e;">:n#0</span> succ <span style="color: #66d9ef; font-weight: bold;">&lt;has-length&gt;</span><span style="color: #797979;">]</span><span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgf995233" class="outline-2">
<h2 id="orgf995233">&lt;sexp&gt; &#x2013; symbol expression</h2>
<div class="outline-text-2" id="text-orgf995233">
</div><div id="outline-container-org576c713" class="outline-3">
<h3 id="org576c713">&lt;sexp&gt;</h3>
<div class="outline-text-3" id="text-org576c713">
<ul class="org-ul">
<li><p>&lt;sexp&gt; := &lt;symbol&gt; | &lt;list&gt;</p></li></ul>

<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+var</span> <span style="color: #66d9ef; font-weight: bold;">&lt;sexp&gt;</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+</span> <span style="color: #66d9ef; font-weight: bold;">&lt;symbol&gt;</span><span style="color: #f92672; font-weight: bold;">,</span> <span style="color: #66d9ef; font-weight: bold;">&lt;sexp&gt;</span> <span style="color: #66d9ef; font-weight: bold;">&lt;list&gt;</span><span style="color: #696969;">))</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">note</span>

  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+fun</span> <span style="color: #66d9ef; font-weight: bold;">&lt;exp&gt;</span> <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #ae81ff;">.&lt;t&gt;</span> <span style="color: #696969;">)</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #696969;">)</span>
    <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+</span> <span style="color: #a6e22e;">:&lt;t&gt;</span><span style="color: #f92672; font-weight: bold;">,</span> <span style="color: #a6e22e;">:&lt;t&gt;</span> <span style="color: #66d9ef; font-weight: bold;">&lt;exp&gt;</span> <span style="color: #66d9ef; font-weight: bold;">&lt;list&gt;</span><span style="color: #696969;">))</span>

  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+var</span> <span style="color: #66d9ef; font-weight: bold;">&lt;sexp&gt;</span>
    <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+</span> <span style="color: #66d9ef; font-weight: bold;">&lt;symbol&gt;</span><span style="color: #f92672; font-weight: bold;">,</span> <span style="color: #66d9ef; font-weight: bold;">&lt;exp&gt;</span><span style="color: #696969;">)))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org50b2590" class="outline-3">
<h3 id="org50b2590">subst</h3>
<div class="outline-text-3" id="text-org50b2590">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+fun</span> subst <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #a6e22e;">:new</span> <span style="color: #66d9ef; font-weight: bold;">&lt;symbol&gt;</span><span style="color: #696969;">)</span>
                <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #a6e22e;">:old</span> <span style="color: #66d9ef; font-weight: bold;">&lt;symbol&gt;</span><span style="color: #696969;">)</span>
                <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #a6e22e;">:sexp</span> <span style="color: #66d9ef; font-weight: bold;">&lt;sexp&gt;</span><span style="color: #696969;">)</span>
             <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #66d9ef; font-weight: bold;">&lt;sexp&gt;</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">case</span> <span style="color: #a6e22e;">:sexp</span>
    <span style="color: #66d9ef; font-weight: bold;">&lt;symbol&gt;</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">match</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:sexp</span> <span style="color: #a6e22e;">:old</span> equal?<span style="color: #797979;">]</span>
               <span style="color: #66d9ef; font-weight: bold;">true</span>  <span style="color: #a6e22e;">:new</span>
               <span style="color: #66d9ef; font-weight: bold;">false</span> <span style="color: #a6e22e;">:sexp</span><span style="color: #696969;">)</span>
    <span style="color: #66d9ef; font-weight: bold;">&lt;list&gt;</span>   <span style="color: #797979;">[</span><span style="color: #a6e22e;">:new</span> <span style="color: #a6e22e;">:old</span> <span style="color: #a6e22e;">:sexp</span> subst-list<span style="color: #797979;">]</span><span style="color: #696969;">))</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+fun</span> subst-list <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #a6e22e;">:new</span> <span style="color: #66d9ef; font-weight: bold;">&lt;symbol&gt;</span><span style="color: #696969;">)</span>
                     <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #a6e22e;">:old</span> <span style="color: #66d9ef; font-weight: bold;">&lt;symbol&gt;</span><span style="color: #696969;">)</span>
                     <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #a6e22e;">:list</span> <span style="color: #66d9ef; font-weight: bold;">&lt;sexp&gt;</span> <span style="color: #66d9ef; font-weight: bold;">&lt;list&gt;</span><span style="color: #696969;">)</span>
                  <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #66d9ef; font-weight: bold;">&lt;sexp&gt;</span> <span style="color: #66d9ef; font-weight: bold;">&lt;list&gt;</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">match</span> <span style="color: #a6e22e;">:list</span>
    null null
    cons <span style="color: #797979;">[</span><span style="color: #a6e22e;">:new</span> <span style="color: #a6e22e;">:old</span> <span style="color: #a6e22e;">:list</span><span style="color: #ae81ff;">.cdr</span> <span style="color: #66d9ef; font-weight: bold;">recur</span>
          <span style="color: #a6e22e;">:new</span> <span style="color: #a6e22e;">:old</span> <span style="color: #a6e22e;">:list</span><span style="color: #ae81ff;">.car</span> subst
          cons<span style="color: #797979;">]</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgb3e19be" class="outline-2">
<h2 id="orgb3e19be">&lt;lexp&gt; &#x2013; lambda expression</h2>
<div class="outline-text-2" id="text-orgb3e19be">
</div><div id="outline-container-orga9e0a05" class="outline-3">
<h3 id="orga9e0a05">&lt;lexp&gt;</h3>
<div class="outline-text-3" id="text-orga9e0a05">
<ul class="org-ul">
<li><p>&lt;lexp&gt; := &lt;var&gt; | (lambda (&lt;var&gt;) &lt;lexp&gt;) | (&lt;lexp&gt; &lt;lexp&gt;)</p></li></ul>

<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+simple-type</span> <span style="color: #66d9ef; font-weight: bold;">&lt;lexp&gt;</span>
  var-lexp <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #ae81ff;">.var</span> <span style="color: #66d9ef; font-weight: bold;">&lt;var&gt;</span><span style="color: #696969;">)</span>
  lam-lexp <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #ae81ff;">.var</span> <span style="color: #66d9ef; font-weight: bold;">&lt;var&gt;</span><span style="color: #696969;">)</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #ae81ff;">.body</span> <span style="color: #66d9ef; font-weight: bold;">&lt;lexp&gt;</span><span style="color: #696969;">)</span>
  app-lexp <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #ae81ff;">.rator</span> <span style="color: #ae81ff;">.rand</span> <span style="color: #66d9ef; font-weight: bold;">&lt;lexp&gt;</span><span style="color: #696969;">))</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+type</span> <span style="color: #66d9ef; font-weight: bold;">&lt;lexp&gt;</span> <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #696969;">)</span>
  var-lexp <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #ae81ff;">.var</span> <span style="color: #66d9ef; font-weight: bold;">&lt;var&gt;</span><span style="color: #696969;">)</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #66d9ef; font-weight: bold;">&lt;lexp&gt;</span><span style="color: #696969;">)</span>
  lam-lexp <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #ae81ff;">.var</span> <span style="color: #66d9ef; font-weight: bold;">&lt;var&gt;</span><span style="color: #696969;">)</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #ae81ff;">.body</span> <span style="color: #66d9ef; font-weight: bold;">&lt;lexp&gt;</span><span style="color: #696969;">)</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #66d9ef; font-weight: bold;">&lt;lexp&gt;</span><span style="color: #696969;">)</span>
  app-lexp <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #ae81ff;">.rator</span> <span style="color: #ae81ff;">.rand</span> <span style="color: #66d9ef; font-weight: bold;">&lt;lexp&gt;</span><span style="color: #696969;">)</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #66d9ef; font-weight: bold;">&lt;lexp&gt;</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb7ccf61" class="outline-3">
<h3 id="orgb7ccf61">occurs-free?</h3>
<div class="outline-text-3" id="text-orgb7ccf61">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+fun</span> occurs-free?
  <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #a6e22e;">:search-var</span> <span style="color: #66d9ef; font-weight: bold;">&lt;var&gt;</span><span style="color: #696969;">)</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #a6e22e;">:lexp</span> <span style="color: #66d9ef; font-weight: bold;">&lt;lexp&gt;</span><span style="color: #696969;">)</span>
   <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #66d9ef; font-weight: bold;">&lt;bool&gt;</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">match</span> <span style="color: #a6e22e;">:lexp</span>
    var-lexp <span style="color: #797979;">[</span><span style="color: #a6e22e;">:search-var</span> <span style="color: #a6e22e;">:lexp</span><span style="color: #ae81ff;">.var</span> equal?<span style="color: #797979;">]</span>
    lam-lexp <span style="color: #797979;">[</span><span style="color: #a6e22e;">:search-var</span> <span style="color: #a6e22e;">:lexp</span><span style="color: #ae81ff;">.var</span> equal? not
              <span style="color: #a6e22e;">:search-var</span> <span style="color: #a6e22e;">:lexp</span><span style="color: #ae81ff;">.body</span> <span style="color: #66d9ef; font-weight: bold;">recur</span> and<span style="color: #797979;">]</span>
    app-lexp <span style="color: #797979;">[</span><span style="color: #a6e22e;">:search-var</span> <span style="color: #a6e22e;">:lexp</span><span style="color: #ae81ff;">.rator</span> <span style="color: #66d9ef; font-weight: bold;">recur</span>
              <span style="color: #a6e22e;">:search-var</span> <span style="color: #a6e22e;">:lexp</span><span style="color: #ae81ff;">.rand</span> <span style="color: #66d9ef; font-weight: bold;">recur</span> or<span style="color: #797979;">]</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orge83efc5" class="outline-2">
<h2 id="orge83efc5">&lt;vector&gt;</h2>
<div class="outline-text-2" id="text-orge83efc5">
</div><div id="outline-container-org12b0352" class="outline-3">
<h3 id="org12b0352">&lt;vector&gt;</h3>
<div class="outline-text-3" id="text-org12b0352">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+type</span> <span style="color: #66d9ef; font-weight: bold;">&lt;vector&gt;</span>
  <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #ae81ff;">.length</span> <span style="color: #66d9ef; font-weight: bold;">&lt;nat&gt;</span><span style="color: #696969;">)</span>
      <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #ae81ff;">.&lt;t&gt;</span> <span style="color: #696969;">)</span>
   <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #696969;">)</span>
  null <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #66d9ef; font-weight: bold;">--</span> zero <span style="color: #a6e22e;">:&lt;t&gt;</span> <span style="color: #66d9ef; font-weight: bold;">&lt;vector&gt;</span><span style="color: #696969;">)</span>
  cons <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #ae81ff;">.cdr</span> <span style="color: #a6e22e;">:n</span> <span style="color: #a6e22e;">:&lt;t&gt;</span> <span style="color: #66d9ef; font-weight: bold;">&lt;vector&gt;</span><span style="color: #696969;">)</span>
           <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #ae81ff;">.car</span> <span style="color: #a6e22e;">:&lt;t&gt;</span><span style="color: #696969;">)</span>
        <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #a6e22e;">:n</span> succ <span style="color: #a6e22e;">:&lt;t&gt;</span> <span style="color: #66d9ef; font-weight: bold;">&lt;vector&gt;</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org6e18c6b" class="outline-3">
<h3 id="org6e18c6b">append</h3>
<div class="outline-text-3" id="text-org6e18c6b">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+fun</span> append <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #a6e22e;">:l0</span> <span style="color: #a6e22e;">:m</span> <span style="color: #a6e22e;">:&lt;t&gt;</span> <span style="color: #66d9ef; font-weight: bold;">&lt;vector&gt;</span><span style="color: #696969;">)</span>
                 <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #a6e22e;">:l1</span> <span style="color: #a6e22e;">:n</span> <span style="color: #a6e22e;">:&lt;t&gt;</span> <span style="color: #66d9ef; font-weight: bold;">&lt;vector&gt;</span><span style="color: #696969;">)</span>
              <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #a6e22e;">:m</span> <span style="color: #a6e22e;">:n</span> add <span style="color: #a6e22e;">:&lt;t&gt;</span> <span style="color: #66d9ef; font-weight: bold;">&lt;vector&gt;</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">match</span> <span style="color: #a6e22e;">:l1</span>
    null <span style="color: #a6e22e;">:l0</span>
    cons <span style="color: #797979;">[</span><span style="color: #a6e22e;">:l0</span> <span style="color: #a6e22e;">:l1</span><span style="color: #ae81ff;">.cdr</span> <span style="color: #66d9ef; font-weight: bold;">recur</span> <span style="color: #a6e22e;">:l1</span><span style="color: #ae81ff;">.car</span> cons<span style="color: #797979;">]</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org4267547" class="outline-3">
<h3 id="org4267547">map</h3>
<div class="outline-text-3" id="text-org4267547">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+fun</span> map <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #a6e22e;">:l</span> <span style="color: #a6e22e;">:n</span> <span style="color: #a6e22e;">:&lt;t1&gt;</span> <span style="color: #66d9ef; font-weight: bold;">&lt;vector&gt;</span><span style="color: #696969;">)</span>
              <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #a6e22e;">:f</span> <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:&lt;t1&gt;</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #a6e22e;">:&lt;t2&gt;</span><span style="color: #696969;">))</span>
           <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #a6e22e;">:n</span> <span style="color: #a6e22e;">:&lt;t2&gt;</span> <span style="color: #66d9ef; font-weight: bold;">&lt;vector&gt;</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">match</span> <span style="color: #a6e22e;">:l</span>
    null null
    cons <span style="color: #797979;">[</span><span style="color: #a6e22e;">:l</span><span style="color: #ae81ff;">.cdr</span> <span style="color: #a6e22e;">:f</span> <span style="color: #66d9ef; font-weight: bold;">recur</span> <span style="color: #a6e22e;">:l</span><span style="color: #ae81ff;">.car</span> <span style="color: #a6e22e;">:f</span> apply cons<span style="color: #797979;">]</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org5688ba3" class="outline-3">
<h3 id="org5688ba3"><span class="todo _note_">[note]</span> type-check detail of 'append'</h3>
<div class="outline-text-3" id="text-org5688ba3">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #a6e22e;">:l0</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:m</span> <span style="color: #a6e22e;">:t</span> <span style="color: #66d9ef; font-weight: bold;">&lt;vector&gt;</span><span style="color: #797979;">]</span><span style="color: #696969;">)</span>
<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #a6e22e;">:l1</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:n</span> <span style="color: #a6e22e;">:t</span> <span style="color: #66d9ef; font-weight: bold;">&lt;vector&gt;</span><span style="color: #797979;">]</span><span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">match</span> <span style="color: #a6e22e;">:l1</span> cons<span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">=</span> <span style="color: #a6e22e;">:l1</span> <span style="color: #a6e22e;">:l1</span><span style="color: #ae81ff;">.cdr</span> <span style="color: #a6e22e;">:l1</span><span style="color: #ae81ff;">.car</span> cons<span style="color: #696969;">)</span>
    <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #a6e22e;">:l1</span><span style="color: #ae81ff;">.cdr</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:n#0</span> <span style="color: #a6e22e;">:t#0</span> <span style="color: #66d9ef; font-weight: bold;">&lt;vector&gt;</span><span style="color: #797979;">]</span><span style="color: #696969;">)</span>
    <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #a6e22e;">:l1</span><span style="color: #ae81ff;">.car</span> <span style="color: #a6e22e;">:t#0</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #a6e22e;">:l1</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:n#0</span> succ <span style="color: #a6e22e;">:t#0</span> <span style="color: #66d9ef; font-weight: bold;">&lt;vector&gt;</span><span style="color: #797979;">]</span><span style="color: #696969;">)</span>
    <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">=</span> <span style="color: #a6e22e;">:n</span> <span style="color: #a6e22e;">:n#0</span> succ<span style="color: #696969;">)</span>
    <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">=</span> <span style="color: #a6e22e;">:t</span> :t#0<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span>type-computed:

 <span style="color: #797979;">[</span><span style="color: #a6e22e;">:l0</span> <span style="color: #a6e22e;">:l1</span><span style="color: #ae81ff;">.cdr</span> <span style="color: #66d9ef; font-weight: bold;">recur</span> <span style="color: #a6e22e;">:l1</span><span style="color: #ae81ff;">.car</span> cons<span style="color: #797979;">]</span>

 <span style="color: #797979;">[</span><span style="color: #a6e22e;">:m</span> <span style="color: #a6e22e;">:t</span> <span style="color: #66d9ef; font-weight: bold;">&lt;vector&gt;</span> <span style="color: #a6e22e;">:n</span> <span style="color: #a6e22e;">:t</span> <span style="color: #66d9ef; font-weight: bold;">&lt;vector&gt;</span><span style="color: #797979;">]</span>
 <span style="color: #797979;">[</span><span style="color: #66d9ef; font-weight: bold;">recur</span> <span style="color: #a6e22e;">:l1</span><span style="color: #ae81ff;">.car</span> cons<span style="color: #797979;">]</span>

 <span style="color: #797979;">[</span><span style="color: #a6e22e;">:m</span> <span style="color: #a6e22e;">:t</span> <span style="color: #66d9ef; font-weight: bold;">&lt;vector&gt;</span> <span style="color: #a6e22e;">:n#0</span> <span style="color: #a6e22e;">:t#0</span> <span style="color: #66d9ef; font-weight: bold;">&lt;vector&gt;</span><span style="color: #797979;">]</span>
 <span style="color: #797979;">[</span><span style="color: #66d9ef; font-weight: bold;">recur</span> <span style="color: #a6e22e;">:l1</span><span style="color: #ae81ff;">.car</span> cons<span style="color: #797979;">]</span>

 <span style="color: #797979;">[</span><span style="color: #a6e22e;">:m</span> <span style="color: #a6e22e;">:n#0</span> add <span style="color: #a6e22e;">:t#0</span> <span style="color: #66d9ef; font-weight: bold;">&lt;vector&gt;</span><span style="color: #797979;">]</span>
 <span style="color: #797979;">[</span><span style="color: #a6e22e;">:l1</span><span style="color: #ae81ff;">.car</span> cons<span style="color: #797979;">]</span>

 <span style="color: #797979;">[</span><span style="color: #a6e22e;">:m</span> <span style="color: #a6e22e;">:n#0</span> add <span style="color: #a6e22e;">:t#0</span> <span style="color: #66d9ef; font-weight: bold;">&lt;vector&gt;</span> <span style="color: #a6e22e;">:t#0</span><span style="color: #797979;">]</span>
 <span style="color: #797979;">[</span>cons<span style="color: #797979;">]</span>

 <span style="color: #797979;">[</span><span style="color: #a6e22e;">:m</span> <span style="color: #a6e22e;">:n#0</span> add succ <span style="color: #a6e22e;">:t#0</span> <span style="color: #66d9ef; font-weight: bold;">&lt;vector&gt;</span><span style="color: #797979;">]</span><span style="color: #696969;">)</span>

<span style="color: #696969;">(</span>type-asserted:

 <span style="color: #797979;">[</span><span style="color: #a6e22e;">:m</span> <span style="color: #a6e22e;">:n</span> add <span style="color: #a6e22e;">:t</span> <span style="color: #66d9ef; font-weight: bold;">&lt;vector&gt;</span><span style="color: #797979;">]</span>

 <span style="color: #797979;">[</span><span style="color: #a6e22e;">:m</span> <span style="color: #a6e22e;">:n#0</span> succ add <span style="color: #a6e22e;">:t#0</span> <span style="color: #66d9ef; font-weight: bold;">&lt;vector&gt;</span><span style="color: #797979;">]</span>

 <span style="color: #797979;">[</span><span style="color: #a6e22e;">:m</span> <span style="color: #a6e22e;">:n#0</span> add succ <span style="color: #a6e22e;">:t#0</span> <span style="color: #66d9ef; font-weight: bold;">&lt;vector&gt;</span><span style="color: #797979;">]</span><span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgecbc8d5" class="outline-3">
<h3 id="orgecbc8d5"><span class="todo _note_">[note]</span> type-check detail of 'map'</h3>
<div class="outline-text-3" id="text-orgecbc8d5">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #a6e22e;">:l</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:n</span> <span style="color: #a6e22e;">:t1</span> <span style="color: #66d9ef; font-weight: bold;">&lt;vector&gt;</span><span style="color: #797979;">]</span><span style="color: #696969;">)</span>
<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #a6e22e;">:f</span> <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:t1</span> :t2<span style="color: #696969;">))</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">match</span> <span style="color: #a6e22e;">:l</span> cons<span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">=</span> <span style="color: #a6e22e;">:l</span> <span style="color: #a6e22e;">:l</span><span style="color: #ae81ff;">.car</span> <span style="color: #a6e22e;">:l</span><span style="color: #ae81ff;">.cdr</span> cons<span style="color: #696969;">)</span>
    <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #a6e22e;">:l</span><span style="color: #ae81ff;">.cdr</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:n#0</span> <span style="color: #a6e22e;">:t#0</span> <span style="color: #66d9ef; font-weight: bold;">&lt;vector&gt;</span><span style="color: #797979;">]</span><span style="color: #696969;">)</span>
    <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #a6e22e;">:l</span><span style="color: #ae81ff;">.car</span> <span style="color: #a6e22e;">:t#0</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #a6e22e;">:l</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:n#0</span> succ <span style="color: #a6e22e;">:t#0</span> <span style="color: #66d9ef; font-weight: bold;">&lt;vector&gt;</span><span style="color: #797979;">]</span><span style="color: #696969;">)</span>
    <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">=</span> <span style="color: #a6e22e;">:n</span> <span style="color: #a6e22e;">:n#0</span> succ<span style="color: #696969;">)</span>
    <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">=</span> <span style="color: #a6e22e;">:t1</span> :t#0<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span>type-computed:

 <span style="color: #797979;">[</span><span style="color: #a6e22e;">:l</span><span style="color: #ae81ff;">.cdr</span> <span style="color: #a6e22e;">:f</span> <span style="color: #66d9ef; font-weight: bold;">recur</span> <span style="color: #a6e22e;">:l</span><span style="color: #ae81ff;">.car</span> <span style="color: #a6e22e;">:f</span> apply cons<span style="color: #797979;">]</span>

 <span style="color: #797979;">[</span><span style="color: #a6e22e;">:n#0</span> <span style="color: #a6e22e;">:t#0</span> <span style="color: #66d9ef; font-weight: bold;">&lt;vector&gt;</span> <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:t1</span> <span style="color: #a6e22e;">:t2</span><span style="color: #696969;">)</span><span style="color: #797979;">]</span>
 <span style="color: #797979;">[</span><span style="color: #66d9ef; font-weight: bold;">recur</span> <span style="color: #a6e22e;">:l</span><span style="color: #ae81ff;">.car</span> <span style="color: #a6e22e;">:f</span> apply cons<span style="color: #797979;">]</span>

 <span style="color: #797979;">[</span><span style="color: #a6e22e;">:n#0</span> <span style="color: #a6e22e;">:t2</span> <span style="color: #66d9ef; font-weight: bold;">&lt;vector&gt;</span><span style="color: #797979;">]</span>
 <span style="color: #797979;">[</span><span style="color: #a6e22e;">:l</span><span style="color: #ae81ff;">.car</span> <span style="color: #a6e22e;">:f</span> apply cons<span style="color: #797979;">]</span>

 <span style="color: #797979;">[</span><span style="color: #a6e22e;">:n#0</span> <span style="color: #a6e22e;">:t2</span> <span style="color: #66d9ef; font-weight: bold;">&lt;vector&gt;</span> <span style="color: #a6e22e;">:t#0</span><span style="color: #797979;">]</span>
 <span style="color: #797979;">[</span><span style="color: #a6e22e;">:f</span> apply cons<span style="color: #797979;">]</span>

 <span style="color: #797979;">[</span><span style="color: #a6e22e;">:n#0</span> <span style="color: #a6e22e;">:t2</span> <span style="color: #66d9ef; font-weight: bold;">&lt;vector&gt;</span> <span style="color: #a6e22e;">:t2</span><span style="color: #797979;">]</span>
 <span style="color: #797979;">[</span>cons<span style="color: #797979;">]</span>

 <span style="color: #797979;">[</span><span style="color: #a6e22e;">:n#0</span> succ <span style="color: #a6e22e;">:t2</span> <span style="color: #66d9ef; font-weight: bold;">&lt;vector&gt;</span><span style="color: #797979;">]</span><span style="color: #696969;">)</span>

<span style="color: #696969;">(</span>type-asserted:

 <span style="color: #797979;">[</span><span style="color: #a6e22e;">:n</span> <span style="color: #a6e22e;">:t2</span> <span style="color: #66d9ef; font-weight: bold;">&lt;vector&gt;</span><span style="color: #797979;">]</span>

 <span style="color: #797979;">[</span><span style="color: #a6e22e;">:n#0</span> succ <span style="color: #a6e22e;">:t2</span> <span style="color: #66d9ef; font-weight: bold;">&lt;vector&gt;</span><span style="color: #797979;">]</span><span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgadf3eea" class="outline-3">
<h3 id="orgadf3eea">&lt;list&gt; as forgetful functor &#x2013; to reuse &lt;vector&gt;</h3>
<div class="outline-text-3" id="text-orgadf3eea">
<ul class="org-ul">
<li><p>forgetful functor of type [not type-class]</p></li></ul>

<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+var</span> <span style="color: #66d9ef; font-weight: bold;">&lt;list&gt;</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">forget</span> <span style="color: #ae81ff;">.length</span> <span style="color: #66d9ef; font-weight: bold;">&lt;vector&gt;</span><span style="color: #696969;">))</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">note</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+fun</span> append <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #a6e22e;">:l0</span> <span style="color: #a6e22e;">:&lt;t&gt;</span> <span style="color: #66d9ef; font-weight: bold;">&lt;list&gt;</span><span style="color: #696969;">)</span>
                   <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #a6e22e;">:l1</span> <span style="color: #a6e22e;">:&lt;t&gt;</span> <span style="color: #66d9ef; font-weight: bold;">&lt;list&gt;</span><span style="color: #696969;">)</span>
                <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #a6e22e;">:&lt;t&gt;</span> <span style="color: #66d9ef; font-weight: bold;">&lt;list&gt;</span><span style="color: #696969;">)</span>
    <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">match</span> <span style="color: #a6e22e;">:l1</span>
      null <span style="color: #a6e22e;">:l0</span>
      cons <span style="color: #797979;">[</span><span style="color: #a6e22e;">:l0</span> <span style="color: #a6e22e;">:l1</span><span style="color: #ae81ff;">.cdr</span> <span style="color: #66d9ef; font-weight: bold;">recur</span> <span style="color: #a6e22e;">:l1</span><span style="color: #ae81ff;">.car</span> cons<span style="color: #797979;">]</span><span style="color: #696969;">)))</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org4e4766d" class="outline-2">
<h2 id="org4e4766d">&lt;binary-tree&gt;</h2>
<div class="outline-text-2" id="text-org4e4766d">
</div><div id="outline-container-org470115" class="outline-3">
<h3 id="org470115">&lt;binary-tree&gt;</h3>
<div class="outline-text-3" id="text-org470115">
<ul class="org-ul">
<li><p>&lt;binary-tree&gt; := () | (&lt;int&gt; &lt;binary-tree&gt; &lt;binary-tree&gt;)</p></li></ul>

<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+simple-type</span> <span style="color: #66d9ef; font-weight: bold;">&lt;binary-tree&gt;</span>
  null
  node <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #ae81ff;">.value</span> <span style="color: #66d9ef; font-weight: bold;">&lt;int&gt;</span><span style="color: #696969;">)</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #ae81ff;">.left</span> <span style="color: #ae81ff;">.right</span> <span style="color: #66d9ef; font-weight: bold;">&lt;binary-tree&gt;</span><span style="color: #696969;">))</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+type</span> <span style="color: #66d9ef; font-weight: bold;">&lt;binary-tree&gt;</span> <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #696969;">)</span>
  null <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #66d9ef; font-weight: bold;">&lt;binary-tree&gt;</span><span style="color: #696969;">)</span>
  node <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #ae81ff;">.value</span> <span style="color: #66d9ef; font-weight: bold;">&lt;int&gt;</span><span style="color: #696969;">)</span>
           <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #ae81ff;">.left</span> <span style="color: #ae81ff;">.right</span> <span style="color: #66d9ef; font-weight: bold;">&lt;binary-tree&gt;</span><span style="color: #696969;">)</span>
        <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #66d9ef; font-weight: bold;">&lt;binary-tree&gt;</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org40e208d" class="outline-2">
<h2 id="org40e208d">&lt;binary-search-tree&gt;</h2>
<div class="outline-text-2" id="text-org40e208d">
</div><div id="outline-container-org8c94fe6" class="outline-3">
<h3 id="org8c94fe6">&lt;binary-search-tree&gt;</h3>
<div class="outline-text-3" id="text-org8c94fe6">
<ul class="org-ul">
<li><p>&lt;binary-search-tree&gt; := () | (&lt;int&gt; &lt;binary-search-tree&gt; &lt;binary-search-tree&gt;)</p></li>

<li><p>not all semantic are expressed in the above grammar.</p><p><ol class="org-ol"></p><p><li>key in the left subtree &lt;= key in the current node</li></p><p><li>keys in the right subtree &gt; key in the current node</li></ol></p></li></ul>

<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+simple-type</span> <span style="color: #66d9ef; font-weight: bold;">&lt;order&gt;</span>
  lt eq gt<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+simple-type</span> <span style="color: #66d9ef; font-weight: bold;">&lt;binary-search-tree&gt;</span>
  null
  node <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #ae81ff;">.key</span> <span style="color: #66d9ef; font-weight: bold;">&lt;symbol&gt;</span><span style="color: #696969;">)</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #ae81ff;">.value</span> <span style="color: #66d9ef; font-weight: bold;">&lt;int&gt;</span><span style="color: #696969;">)</span>
       <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #ae81ff;">.left</span> <span style="color: #ae81ff;">.right</span> <span style="color: #66d9ef; font-weight: bold;">&lt;binary-search-tree&gt;</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org4976c2a" class="outline-3">
<h3 id="org4976c2a">search</h3>
<div class="outline-text-3" id="text-org4976c2a">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+fun</span> search <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #a6e22e;">:tree</span> <span style="color: #66d9ef; font-weight: bold;">&lt;binary-search-tree&gt;</span><span style="color: #696969;">)</span>
                 <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #a6e22e;">:key</span> <span style="color: #66d9ef; font-weight: bold;">&lt;symbol&gt;</span><span style="color: #696969;">)</span>
              <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #66d9ef; font-weight: bold;">&lt;binary-search-tree&gt;</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">match</span> <span style="color: #a6e22e;">:tree</span>
    null null
    node <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">match</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:key</span> <span style="color: #a6e22e;">:tree</span><span style="color: #ae81ff;">.key</span> compare<span style="color: #797979;">]</span>
           lt <span style="color: #797979;">[</span><span style="color: #a6e22e;">:tree</span><span style="color: #ae81ff;">.left</span> <span style="color: #a6e22e;">:key</span> <span style="color: #66d9ef; font-weight: bold;">recur</span><span style="color: #797979;">]</span>
           eq <span style="color: #797979;">[</span><span style="color: #a6e22e;">:tree</span><span style="color: #797979;">]</span>
           gt <span style="color: #797979;">[</span><span style="color: #a6e22e;">:tree</span><span style="color: #ae81ff;">.right</span> <span style="color: #a6e22e;">:key</span> <span style="color: #66d9ef; font-weight: bold;">recur</span><span style="color: #797979;">]</span><span style="color: #696969;">)))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org6b2d045" class="outline-3">
<h3 id="org6b2d045">insert</h3>
<div class="outline-text-3" id="text-org6b2d045">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+fun</span> insert <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #a6e22e;">:tree</span> <span style="color: #66d9ef; font-weight: bold;">&lt;binary-search-tree&gt;</span><span style="color: #696969;">)</span>
                 <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #a6e22e;">:key</span> <span style="color: #66d9ef; font-weight: bold;">&lt;symbol&gt;</span><span style="color: #696969;">)</span>
                 <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #a6e22e;">:vlaue</span> <span style="color: #66d9ef; font-weight: bold;">&lt;int&gt;</span><span style="color: #696969;">)</span>
              <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #66d9ef; font-weight: bold;">&lt;binary-search-tree&gt;</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">match</span> <span style="color: #a6e22e;">:tree</span>
    null <span style="color: #797979;">[</span><span style="color: #a6e22e;">:key</span> <span style="color: #a6e22e;">:value</span> null null node<span style="color: #797979;">]</span>
    node <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">match</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:key</span> <span style="color: #a6e22e;">:tree</span><span style="color: #ae81ff;">.key</span> compare<span style="color: #797979;">]</span>
           lt <span style="color: #797979;">[</span><span style="color: #a6e22e;">:tree</span><span style="color: #ae81ff;">.key</span> <span style="color: #a6e22e;">:tree</span><span style="color: #ae81ff;">.value</span>
               <span style="color: #a6e22e;">:tree</span><span style="color: #ae81ff;">.left</span> <span style="color: #a6e22e;">:key</span> <span style="color: #a6e22e;">:value</span> <span style="color: #66d9ef; font-weight: bold;">recur</span> <span style="color: #a6e22e;">:tree</span><span style="color: #ae81ff;">.right</span> node<span style="color: #797979;">]</span>
           eq <span style="color: #797979;">[</span><span style="color: #a6e22e;">:key</span> <span style="color: #a6e22e;">:value</span>
               <span style="color: #a6e22e;">:tree</span><span style="color: #ae81ff;">.left</span> <span style="color: #a6e22e;">:tree</span><span style="color: #ae81ff;">.right</span> node<span style="color: #797979;">]</span>
           gt <span style="color: #797979;">[</span><span style="color: #a6e22e;">:tree</span><span style="color: #ae81ff;">.key</span> <span style="color: #a6e22e;">:tree</span><span style="color: #ae81ff;">.value</span>
               <span style="color: #a6e22e;">:tree</span><span style="color: #ae81ff;">.left</span> <span style="color: #a6e22e;">:tree</span><span style="color: #ae81ff;">.right</span> <span style="color: #a6e22e;">:key</span> <span style="color: #a6e22e;">:value</span> <span style="color: #66d9ef; font-weight: bold;">recur</span> node<span style="color: #797979;">]</span><span style="color: #696969;">)))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org6e35e86" class="outline-3">
<h3 id="org6e35e86">delete</h3>
<div class="outline-text-3" id="text-org6e35e86">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+fun</span> delete <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #a6e22e;">:tree</span> <span style="color: #66d9ef; font-weight: bold;">&lt;binary-search-tree&gt;</span><span style="color: #696969;">)</span>
                 <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #a6e22e;">:key</span> <span style="color: #66d9ef; font-weight: bold;">&lt;symbol&gt;</span><span style="color: #696969;">)</span>
              <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #66d9ef; font-weight: bold;">&lt;binary-search-tree&gt;</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">match</span> <span style="color: #a6e22e;">:tree</span>
    null null
    node <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">match</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:key</span> <span style="color: #a6e22e;">:tree</span><span style="color: #ae81ff;">.key</span> compare<span style="color: #797979;">]</span>
           lt <span style="color: #797979;">[</span><span style="color: #a6e22e;">:tree</span><span style="color: #ae81ff;">.key</span> <span style="color: #a6e22e;">:tree</span><span style="color: #ae81ff;">.value</span>
               <span style="color: #a6e22e;">:tree</span><span style="color: #ae81ff;">.left</span> <span style="color: #a6e22e;">:key</span> <span style="color: #66d9ef; font-weight: bold;">recur</span> <span style="color: #a6e22e;">:tree</span><span style="color: #ae81ff;">.right</span> node<span style="color: #797979;">]</span>
           eq <span style="color: #797979;">[</span><span style="color: #a6e22e;">:tree</span> delete-node<span style="color: #797979;">]</span>
           gt <span style="color: #797979;">[</span><span style="color: #a6e22e;">:tree</span><span style="color: #ae81ff;">.key</span> <span style="color: #a6e22e;">:tree</span><span style="color: #ae81ff;">.value</span>
               <span style="color: #a6e22e;">:tree</span><span style="color: #ae81ff;">.left</span> <span style="color: #a6e22e;">:tree</span><span style="color: #ae81ff;">.right</span> <span style="color: #a6e22e;">:key</span> <span style="color: #66d9ef; font-weight: bold;">recur</span> node<span style="color: #797979;">]</span><span style="color: #696969;">)))</span>


<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+fun</span> delete-node <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #a6e22e;">:tree</span> <span style="color: #66d9ef; font-weight: bold;">&lt;binary-search-tree&gt;</span><span style="color: #696969;">)</span>
                   <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #66d9ef; font-weight: bold;">&lt;binary-search-tree&gt;</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">cond</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:tree</span><span style="color: #ae81ff;">.left</span> null?<span style="color: #797979;">]</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:tree</span><span style="color: #ae81ff;">.right</span><span style="color: #797979;">]</span>
        <span style="color: #797979;">[</span><span style="color: #a6e22e;">:tree</span><span style="color: #ae81ff;">.right</span> null?<span style="color: #797979;">]</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:tree</span><span style="color: #ae81ff;">.left</span><span style="color: #797979;">]</span>
        <span style="color: #66d9ef; font-weight: bold;">else</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:tree</span><span style="color: #ae81ff;">.right</span> left-most-key-and-value <span style="color: #fd971f;">:value!</span> <span style="color: #fd971f;">:key!</span>
              <span style="color: #a6e22e;">:key</span> <span style="color: #a6e22e;">:value</span>
              <span style="color: #a6e22e;">:tree</span><span style="color: #ae81ff;">.left</span>
              <span style="color: #a6e22e;">:tree</span><span style="color: #ae81ff;">.right</span> <span style="color: #a6e22e;">:key</span> delete
              node<span style="color: #797979;">]</span><span style="color: #696969;">))</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+fun</span> left-most-key-and-value <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #a6e22e;">:tree</span> <span style="color: #66d9ef; font-weight: bold;">&lt;binary-search-tree&gt;</span><span style="color: #696969;">)</span>
                               <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #66d9ef; font-weight: bold;">&lt;symbol&gt;</span> <span style="color: #66d9ef; font-weight: bold;">&lt;int&gt;</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">cond</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:tree</span><span style="color: #ae81ff;">.left</span> null?<span style="color: #797979;">]</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:tree</span><span style="color: #ae81ff;">.key</span> <span style="color: #a6e22e;">:tree</span><span style="color: #ae81ff;">.value</span><span style="color: #797979;">]</span>
        <span style="color: #66d9ef; font-weight: bold;">else</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:tree</span><span style="color: #ae81ff;">.left</span> <span style="color: #66d9ef; font-weight: bold;">recur</span><span style="color: #797979;">]</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org502be66" class="outline-2">
<h2 id="org502be66"><span class="todo _gt__lt_">&gt;&lt;</span> &lt;red-black-tree&gt;</h2>
<div class="outline-text-2" id="text-org502be66">
</div><div id="outline-container-org690dd9d" class="outline-3">
<h3 id="org690dd9d"><span class="todo _note_">[note]</span> </h3>
<div class="outline-text-3" id="text-org690dd9d">
<ul class="org-ul">
<li><p>in addition to the requirements imposed on a binary search tree</p><p>the following must be satisfied by a redblack tree :</p><p><ol class="org-ol"></p><p><li>each node is either red or black.</li></p><p><li>the root is black. [this rule is sometimes omitted.]</li></p><p><li>all leaves are black.</li></p><p><li>if a node is red, then both its children are black.</li></p><p><li>every path from a given node to any of its descendant nil nodes</p><p>contains the same number of black nodes.</p><p></p><p><ul class="org-ul"></p><p><li><p>the number of black nodes from the root to a node</p><p>is the node's black depth</p></li></p><p></p><p><li><p>the uniform number of black nodes in all paths</p><p>from root to the leaves</p><p>is called the black-height of the redblack tree.</p></li></ul></li></ol></p></li>

<li><p>property of redblack trees :</p><p>the path from the root to the farthest leaf</p><p>is no more than twice as long as the path</p><p>from the root to the nearest leaf.</p><p>thus, the tree is roughly height-balanced.</p></li></ul>
</div>
</div>

<div id="outline-container-org4347b49" class="outline-3">
<h3 id="org4347b49">&lt;red-black-tree&gt; &#x2013; extrinsic</h3>
<div class="outline-text-3" id="text-org4347b49">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+simple-type</span> <span style="color: #66d9ef; font-weight: bold;">&lt;color&gt;</span>
  red
  black<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+simple-type</span> <span style="color: #66d9ef; font-weight: bold;">&lt;red-black-tree&gt;</span>
  null
  node <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #ae81ff;">.color</span> <span style="color: #66d9ef; font-weight: bold;">&lt;color&gt;</span><span style="color: #696969;">)</span>
       <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #ae81ff;">.key</span> <span style="color: #66d9ef; font-weight: bold;">&lt;symbol&gt;</span><span style="color: #696969;">)</span>
       <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #ae81ff;">.value</span> <span style="color: #66d9ef; font-weight: bold;">&lt;int&gt;</span><span style="color: #696969;">)</span>
       <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #ae81ff;">.left</span> <span style="color: #ae81ff;">.right</span> <span style="color: #66d9ef; font-weight: bold;">&lt;red-black-tree&gt;</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org62c928e" class="outline-3">
<h3 id="org62c928e">&lt;red-black-tree&gt; &#x2013; intrinsic</h3>
<div class="outline-text-3" id="text-org62c928e">
<div class="org-src-container">

<pre class="src src-jojo"></pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org242e298" class="outline-2">
<h2 id="org242e298">type-class as subtype of <a id="orgb48e660"></a></h2>
<div class="outline-text-2" id="text-org242e298">
</div><div id="outline-container-org21eda19" class="outline-3">
<h3 id="org21eda19"><a id="orgb6a0066"></a></h3>
<div class="outline-text-3" id="text-org21eda19">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+subtype</span>  <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span>  <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #696969;">)</span>
  map <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #a6e22e;">:x1</span> <span style="color: #a6e22e;">:&lt;t1&gt;</span> <span style="color: #66d9ef; font-weight: bold;">&lt;functor&gt;</span><span style="color: #696969;">)</span>
          <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #a6e22e;">:f</span> <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:&lt;t1&gt;</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #a6e22e;">:&lt;t2&gt;</span><span style="color: #696969;">))</span>
       <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #a6e22e;">:&lt;t2&gt;</span> <span style="color: #66d9ef; font-weight: bold;">&lt;functor&gt;</span><span style="color: #696969;">))</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+member</span> <span style="color: #66d9ef; font-weight: bold;">&lt;list&gt;</span> 
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+imp</span> map <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #a6e22e;">:x1</span> <span style="color: #a6e22e;">:&lt;t1&gt;</span> <span style="color: #66d9ef; font-weight: bold;">&lt;list&gt;</span><span style="color: #696969;">)</span>
                <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #a6e22e;">:f</span> <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:&lt;t1&gt;</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #a6e22e;">:&lt;t2&gt;</span><span style="color: #696969;">))</span>
             <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #a6e22e;">:&lt;t2&gt;</span> <span style="color: #66d9ef; font-weight: bold;">&lt;list&gt;</span><span style="color: #696969;">)</span>
    <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">match</span> <span style="color: #a6e22e;">:x1</span>
      null null
      cons <span style="color: #797979;">[</span><span style="color: #a6e22e;">:x1</span><span style="color: #ae81ff;">.cdr</span> <span style="color: #a6e22e;">:f</span> <span style="color: #66d9ef; font-weight: bold;">recur</span><span style="color: #f92672; font-weight: bold;">,</span> <span style="color: #a6e22e;">:x1</span><span style="color: #ae81ff;">.car</span> <span style="color: #a6e22e;">:f</span> apply<span style="color: #f92672; font-weight: bold;">,</span> cons<span style="color: #797979;">]</span><span style="color: #696969;">)))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org21ce4ce" class="outline-3">
<h3 id="org21ce4ce"><a id="org4f8f931"></a></h3>
<div class="outline-text-3" id="text-org21ce4ce">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+subtype</span>  <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span>  <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #696969;">)</span>
  return <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #a6e22e;">:val</span> <span style="color: #a6e22e;">:&lt;t&gt;</span><span style="color: #696969;">)</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #a6e22e;">:&lt;t&gt;</span> <span style="color: #66d9ef; font-weight: bold;">&lt;monad&gt;</span><span style="color: #696969;">)</span>
  bind <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #a6e22e;">:value</span> <span style="color: #a6e22e;">:&lt;t1&gt;</span> <span style="color: #66d9ef; font-weight: bold;">&lt;monad&gt;</span><span style="color: #696969;">)</span>
           <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #a6e22e;">:f</span> <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:&lt;t1&gt;</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #a6e22e;">:&lt;t2&gt;</span> <span style="color: #66d9ef; font-weight: bold;">&lt;monad&gt;</span><span style="color: #696969;">))</span>
        <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #a6e22e;">:&lt;t2&gt;</span> <span style="color: #66d9ef; font-weight: bold;">&lt;monad&gt;</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org524dd53" class="outline-3">
<h3 id="org524dd53">&lt;maybe&gt;</h3>
<div class="outline-text-3" id="text-org524dd53">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+type</span> <span style="color: #66d9ef; font-weight: bold;">&lt;maybe&gt;</span> <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #ae81ff;">.&lt;t&gt;</span> <span style="color: #696969;">)</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #696969;">)</span>
  nothing <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #a6e22e;">:&lt;t&gt;</span> <span style="color: #66d9ef; font-weight: bold;">&lt;maybe&gt;</span><span style="color: #696969;">)</span>
  just <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #ae81ff;">.value</span> <span style="color: #a6e22e;">:&lt;t&gt;</span><span style="color: #696969;">)</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #a6e22e;">:&lt;t&gt;</span> <span style="color: #66d9ef; font-weight: bold;">&lt;maybe&gt;</span><span style="color: #696969;">))</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+member</span> <span style="color: #66d9ef; font-weight: bold;">&lt;maybe&gt;</span> 
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+imp</span> return <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #a6e22e;">:v</span> <span style="color: #a6e22e;">:&lt;t&gt;</span><span style="color: #696969;">)</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #a6e22e;">:&lt;t&gt;</span> <span style="color: #66d9ef; font-weight: bold;">&lt;maybe&gt;</span><span style="color: #696969;">)</span>
    <span style="color: #a6e22e;">:v</span> just<span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+imp</span> bind <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #a6e22e;">:m</span> <span style="color: #a6e22e;">:&lt;t1&gt;</span> <span style="color: #66d9ef; font-weight: bold;">&lt;maybe&gt;</span><span style="color: #696969;">)</span>
                 <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #a6e22e;">:f</span> <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:&lt;t1&gt;</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #a6e22e;">:&lt;t2&gt;</span> <span style="color: #66d9ef; font-weight: bold;">&lt;maybe&gt;</span><span style="color: #696969;">))</span>
              <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #a6e22e;">:&lt;t2&gt;</span> <span style="color: #66d9ef; font-weight: bold;">&lt;maybe&gt;</span><span style="color: #696969;">)</span>
    <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">match</span> <span style="color: #a6e22e;">:m</span>
      nothing nothing
      just <span style="color: #797979;">[</span><span style="color: #a6e22e;">:m</span><span style="color: #ae81ff;">.value</span> <span style="color: #a6e22e;">:f</span> apply<span style="color: #797979;">]</span><span style="color: #696969;">)))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org7b02b18" class="outline-3">
<h3 id="org7b02b18">&lt;state&gt;</h3>
<div class="outline-text-3" id="text-org7b02b18">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+var</span> <span style="color: #66d9ef; font-weight: bold;">&lt;state&gt;</span> <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:&lt;s&gt;</span> <span style="color: #a6e22e;">:&lt;v&gt;</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:&lt;s&gt;</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #a6e22e;">:&lt;s&gt;</span> :&lt;v&gt;<span style="color: #696969;">))</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+member</span> <span style="color: #B380A8;">{</span><span style="color: #a6e22e;">:&lt;s&gt;</span> <span style="color: #66d9ef; font-weight: bold;">&lt;state&gt;</span><span style="color: #B380A8;">}</span> 
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+imp</span> return <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #a6e22e;">:v</span> <span style="color: #a6e22e;">:&lt;v&gt;</span><span style="color: #696969;">)</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #a6e22e;">:&lt;s&gt;</span> <span style="color: #a6e22e;">:&lt;v&gt;</span> <span style="color: #66d9ef; font-weight: bold;">&lt;state&gt;</span><span style="color: #696969;">)</span>
    <span style="color: #B380A8;">{</span><span style="color: #a6e22e;">:v</span><span style="color: #B380A8;">}</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+imp</span> bind <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #a6e22e;">:m</span> <span style="color: #a6e22e;">:&lt;s&gt;</span> <span style="color: #a6e22e;">:&lt;v1&gt;</span> <span style="color: #66d9ef; font-weight: bold;">&lt;state&gt;</span><span style="color: #696969;">)</span>
                 <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #a6e22e;">:f</span> <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:&lt;v1&gt;</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #a6e22e;">:&lt;s&gt;</span> <span style="color: #a6e22e;">:&lt;v2&gt;</span> <span style="color: #66d9ef; font-weight: bold;">&lt;state&gt;</span><span style="color: #696969;">))</span>
              <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #a6e22e;">:&lt;s&gt;</span> <span style="color: #a6e22e;">:&lt;v2&gt;</span> <span style="color: #66d9ef; font-weight: bold;">&lt;state&gt;</span><span style="color: #696969;">)</span>
    <span style="color: #B380A8;">{</span><span style="color: #a6e22e;">:m</span> apply <span style="color: #a6e22e;">:f</span> apply apply<span style="color: #B380A8;">}</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgb6a941f" class="outline-2">
<h2 id="orgb6a941f">quotype &#x2013; quotient type</h2>
<div class="outline-text-2" id="text-orgb6a941f">
</div><div id="outline-container-org8c6f2d4" class="outline-3">
<h3 id="org8c6f2d4"><span class="todo _note_">[note]</span> </h3>
<div class="outline-text-3" id="text-org8c6f2d4">
<ul class="org-ul">
<li><p>basic 'equal?'</p></li>

<li><p><p></p><p>to use quotype is to to re-implement 'equal?'.</p><p></p></p><p></p><p><p></p><p>or, generally,</p><p>to re-implement interface functions</p><p>of type and type-class</p><p></p></p></li></ul>
</div>
</div>

<div id="outline-container-org4bd4140" class="outline-3">
<h3 id="org4bd4140">&lt;int&gt;</h3>
<div class="outline-text-3" id="text-org4bd4140">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+simple-quotype</span> <span style="color: #66d9ef; font-weight: bold;">&lt;int&gt;</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #ae81ff;">.left</span> <span style="color: #ae81ff;">.right</span> <span style="color: #66d9ef; font-weight: bold;">&lt;nat&gt;</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org4e61c0d" class="outline-3">
<h3 id="org4e61c0d">equal?</h3>
<div class="outline-text-3" id="text-org4e61c0d">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+fun</span> equal? <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #a6e22e;">:x</span> <span style="color: #a6e22e;">:y</span> <span style="color: #66d9ef; font-weight: bold;">&lt;int&gt;</span><span style="color: #696969;">)</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #66d9ef; font-weight: bold;">&lt;bool&gt;</span><span style="color: #696969;">)</span>
  <span style="color: #a6e22e;">:x</span><span style="color: #ae81ff;">.left</span> <span style="color: #a6e22e;">:x</span><span style="color: #ae81ff;">.right</span> sub
  <span style="color: #a6e22e;">:y</span><span style="color: #ae81ff;">.left</span> <span style="color: #a6e22e;">:y</span><span style="color: #ae81ff;">.right</span> sub
  equal?<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgac2c448" class="outline-3">
<h3 id="orgac2c448">&lt;fraction&gt;</h3>
<div class="outline-text-3" id="text-orgac2c448">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+simple-quotype</span> <span style="color: #66d9ef; font-weight: bold;">&lt;fraction&gt;</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #ae81ff;">.up</span> <span style="color: #ae81ff;">.down</span> <span style="color: #66d9ef; font-weight: bold;">&lt;int&gt;</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orga998f2f" class="outline-3">
<h3 id="orga998f2f">equal?</h3>
<div class="outline-text-3" id="text-orga998f2f">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+fun</span> equal? <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #a6e22e;">:x</span> <span style="color: #a6e22e;">:y</span> <span style="color: #66d9ef; font-weight: bold;">&lt;fraction&gt;</span><span style="color: #696969;">)</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #66d9ef; font-weight: bold;">&lt;bool&gt;</span><span style="color: #696969;">)</span>
  <span style="color: #a6e22e;">:x</span><span style="color: #ae81ff;">.up</span> <span style="color: #a6e22e;">:y</span><span style="color: #ae81ff;">.down</span> mul
  <span style="color: #a6e22e;">:y</span><span style="color: #ae81ff;">.up</span> <span style="color: #a6e22e;">:x</span><span style="color: #ae81ff;">.down</span> mul
  equal?<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: xieyuheng</p>
<p class="date">Created: 2017-09-25 Mon 02:40</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
